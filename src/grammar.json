{
  "name": "suricataRules",
  "rules": {
    "source_file": {
      "type": "REPEAT",
      "content": {
        "type": "SYMBOL",
        "name": "_lines"
      }
    },
    "_lines": {
      "type": "CHOICE",
      "members": [
        {
          "type": "SYMBOL",
          "name": "comment"
        },
        {
          "type": "SYMBOL",
          "name": "_rule"
        }
      ]
    },
    "comment": {
      "type": "SEQ",
      "members": [
        {
          "type": "STRING",
          "value": "#"
        },
        {
          "type": "PATTERN",
          "value": ".*"
        }
      ]
    },
    "_rule": {
      "type": "SEQ",
      "members": [
        {
          "type": "SYMBOL",
          "name": "action"
        },
        {
          "type": "SYMBOL",
          "name": "header"
        },
        {
          "type": "SYMBOL",
          "name": "options"
        }
      ]
    },
    "action": {
      "type": "CHOICE",
      "members": [
        {
          "type": "STRING",
          "value": "alert"
        },
        {
          "type": "STRING",
          "value": "pass"
        },
        {
          "type": "STRING",
          "value": "drop"
        },
        {
          "type": "STRING",
          "value": "reject"
        },
        {
          "type": "STRING",
          "value": "rejectsrc"
        },
        {
          "type": "STRING",
          "value": "rejectdst"
        },
        {
          "type": "STRING",
          "value": "rejectboth"
        }
      ]
    },
    "header": {
      "type": "SEQ",
      "members": [
        {
          "type": "SYMBOL",
          "name": "protocol"
        },
        {
          "type": "SYMBOL",
          "name": "_location"
        },
        {
          "type": "SYMBOL",
          "name": "_port_choices"
        },
        {
          "type": "SYMBOL",
          "name": "direction"
        },
        {
          "type": "SYMBOL",
          "name": "_location"
        },
        {
          "type": "SYMBOL",
          "name": "_port_choices"
        }
      ]
    },
    "protocol": {
      "type": "CHOICE",
      "members": [
        {
          "type": "STRING",
          "value": "tcp"
        },
        {
          "type": "STRING",
          "value": "udp"
        },
        {
          "type": "STRING",
          "value": "icmp"
        },
        {
          "type": "STRING",
          "value": "ip"
        },
        {
          "type": "STRING",
          "value": "http"
        },
        {
          "type": "STRING",
          "value": "ftp"
        },
        {
          "type": "STRING",
          "value": "tls"
        },
        {
          "type": "STRING",
          "value": "smb"
        },
        {
          "type": "STRING",
          "value": "dns"
        },
        {
          "type": "STRING",
          "value": "dcerpc"
        },
        {
          "type": "STRING",
          "value": "ssh"
        },
        {
          "type": "STRING",
          "value": "smtp"
        },
        {
          "type": "STRING",
          "value": "imap"
        },
        {
          "type": "STRING",
          "value": "modbus"
        },
        {
          "type": "STRING",
          "value": "dnp3"
        },
        {
          "type": "STRING",
          "value": "enip"
        },
        {
          "type": "STRING",
          "value": "nfs"
        },
        {
          "type": "STRING",
          "value": "ikev2"
        },
        {
          "type": "STRING",
          "value": "krb5"
        },
        {
          "type": "STRING",
          "value": "ntp"
        },
        {
          "type": "STRING",
          "value": "dhcp"
        },
        {
          "type": "STRING",
          "value": "rfb"
        },
        {
          "type": "STRING",
          "value": "rdp"
        },
        {
          "type": "STRING",
          "value": "snmp"
        },
        {
          "type": "STRING",
          "value": "tftp"
        },
        {
          "type": "STRING",
          "value": "sip"
        },
        {
          "type": "STRING",
          "value": "http2"
        }
      ]
    },
    "_location": {
      "type": "CHOICE",
      "members": [
        {
          "type": "SYMBOL",
          "name": "_standalone_location"
        },
        {
          "type": "SYMBOL",
          "name": "group_location"
        }
      ]
    },
    "_standalone_location": {
      "type": "SEQ",
      "members": [
        {
          "type": "CHOICE",
          "members": [
            {
              "type": "SYMBOL",
              "name": "negation"
            },
            {
              "type": "BLANK"
            }
          ]
        },
        {
          "type": "CHOICE",
          "members": [
            {
              "type": "SYMBOL",
              "name": "variable"
            },
            {
              "type": "SYMBOL",
              "name": "ipv4"
            },
            {
              "type": "SYMBOL",
              "name": "ipv6"
            }
          ]
        }
      ]
    },
    "group_location": {
      "type": "SEQ",
      "members": [
        {
          "type": "CHOICE",
          "members": [
            {
              "type": "SYMBOL",
              "name": "negation"
            },
            {
              "type": "BLANK"
            }
          ]
        },
        {
          "type": "STRING",
          "value": "["
        },
        {
          "type": "CHOICE",
          "members": [
            {
              "type": "SEQ",
              "members": [
                {
                  "type": "SYMBOL",
                  "name": "_location"
                },
                {
                  "type": "REPEAT",
                  "content": {
                    "type": "SEQ",
                    "members": [
                      {
                        "type": "STRING",
                        "value": ","
                      },
                      {
                        "type": "SYMBOL",
                        "name": "_location"
                      }
                    ]
                  }
                }
              ]
            },
            {
              "type": "BLANK"
            }
          ]
        },
        {
          "type": "STRING",
          "value": "]"
        }
      ]
    },
    "negation": {
      "type": "STRING",
      "value": "!"
    },
    "variable": {
      "type": "SEQ",
      "members": [
        {
          "type": "STRING",
          "value": "$"
        },
        {
          "type": "PATTERN",
          "value": "[a-zA-Z_]*"
        }
      ]
    },
    "ipv4": {
      "type": "SEQ",
      "members": [
        {
          "type": "PATTERN",
          "value": "\\d+\\.\\d+\\.\\d+\\.\\d+"
        },
        {
          "type": "CHOICE",
          "members": [
            {
              "type": "PATTERN",
              "value": "\\/\\d+"
            },
            {
              "type": "BLANK"
            }
          ]
        }
      ]
    },
    "ipv6": {
      "type": "SEQ",
      "members": [
        {
          "type": "REPEAT1",
          "content": {
            "type": "SYMBOL",
            "name": "_ipv6_octet"
          }
        },
        {
          "type": "CHOICE",
          "members": [
            {
              "type": "PATTERN",
              "value": "\\/\\d+"
            },
            {
              "type": "BLANK"
            }
          ]
        }
      ]
    },
    "_ipv6_octet": {
      "type": "PATTERN",
      "value": "[0-9a-fA-F]{1,4}:{0,2}"
    },
    "_port_choices": {
      "type": "CHOICE",
      "members": [
        {
          "type": "SYMBOL",
          "name": "port"
        },
        {
          "type": "SYMBOL",
          "name": "group_port"
        }
      ]
    },
    "port": {
      "type": "CHOICE",
      "members": [
        {
          "type": "STRING",
          "value": "any"
        },
        {
          "type": "SEQ",
          "members": [
            {
              "type": "CHOICE",
              "members": [
                {
                  "type": "SYMBOL",
                  "name": "negation"
                },
                {
                  "type": "BLANK"
                }
              ]
            },
            {
              "type": "PATTERN",
              "value": "\\d{1,4}"
            },
            {
              "type": "CHOICE",
              "members": [
                {
                  "type": "ALIAS",
                  "content": {
                    "type": "SYMBOL",
                    "name": "colon"
                  },
                  "named": true,
                  "value": "port_range"
                },
                {
                  "type": "BLANK"
                }
              ]
            }
          ]
        }
      ]
    },
    "group_port": {
      "type": "SEQ",
      "members": [
        {
          "type": "CHOICE",
          "members": [
            {
              "type": "SYMBOL",
              "name": "negation"
            },
            {
              "type": "BLANK"
            }
          ]
        },
        {
          "type": "STRING",
          "value": "["
        },
        {
          "type": "CHOICE",
          "members": [
            {
              "type": "SEQ",
              "members": [
                {
                  "type": "SYMBOL",
                  "name": "_port_choices"
                },
                {
                  "type": "REPEAT",
                  "content": {
                    "type": "SEQ",
                    "members": [
                      {
                        "type": "STRING",
                        "value": ","
                      },
                      {
                        "type": "SYMBOL",
                        "name": "_port_choices"
                      }
                    ]
                  }
                }
              ]
            },
            {
              "type": "BLANK"
            }
          ]
        },
        {
          "type": "STRING",
          "value": "]"
        }
      ]
    },
    "colon": {
      "type": "STRING",
      "value": ":"
    },
    "direction": {
      "type": "CHOICE",
      "members": [
        {
          "type": "STRING",
          "value": "->"
        },
        {
          "type": "STRING",
          "value": "<>"
        }
      ]
    },
    "options": {
      "type": "SEQ",
      "members": [
        {
          "type": "STRING",
          "value": "("
        },
        {
          "type": "CHOICE",
          "members": [
            {
              "type": "SEQ",
              "members": [
                {
                  "type": "SYMBOL",
                  "name": "_opt"
                },
                {
                  "type": "STRING",
                  "value": ";"
                },
                {
                  "type": "REPEAT",
                  "content": {
                    "type": "SEQ",
                    "members": [
                      {
                        "type": "SYMBOL",
                        "name": "_opt"
                      },
                      {
                        "type": "STRING",
                        "value": ";"
                      }
                    ]
                  }
                }
              ]
            },
            {
              "type": "BLANK"
            }
          ]
        },
        {
          "type": "STRING",
          "value": ")"
        }
      ]
    },
    "_opt": {
      "type": "SEQ",
      "members": [
        {
          "type": "ALIAS",
          "content": {
            "type": "SYMBOL",
            "name": "text"
          },
          "named": true,
          "value": "keyword"
        },
        {
          "type": "CHOICE",
          "members": [
            {
              "type": "SEQ",
              "members": [
                {
                  "type": "ALIAS",
                  "content": {
                    "type": "SYMBOL",
                    "name": "colon"
                  },
                  "named": true,
                  "value": "separator"
                },
                {
                  "type": "SYMBOL",
                  "name": "value"
                }
              ]
            },
            {
              "type": "BLANK"
            }
          ]
        }
      ]
    },
    "digit": {
      "type": "SEQ",
      "members": [
        {
          "type": "CHOICE",
          "members": [
            {
              "type": "CHOICE",
              "members": [
                {
                  "type": "STRING",
                  "value": ">"
                },
                {
                  "type": "STRING",
                  "value": "<"
                }
              ]
            },
            {
              "type": "BLANK"
            }
          ]
        },
        {
          "type": "PATTERN",
          "value": "\\d+"
        }
      ]
    },
    "text": {
      "type": "SEQ",
      "members": [
        {
          "type": "REPEAT1",
          "content": {
            "type": "IMMEDIATE_TOKEN",
            "content": {
              "type": "PATTERN",
              "value": "[^\"!:;\\(\\)\\n]+"
            }
          }
        }
      ]
    },
    "string": {
      "type": "SEQ",
      "members": [
        {
          "type": "STRING",
          "value": "\""
        },
        {
          "type": "REPEAT",
          "content": {
            "type": "IMMEDIATE_TOKEN",
            "content": {
              "type": "PATTERN",
              "value": "[^\"\\n]+"
            }
          }
        },
        {
          "type": "STRING",
          "value": "\""
        }
      ]
    },
    "decimal": {
      "type": "PATTERN",
      "value": "\\d+.\\d+"
    },
    "hexidecimal": {
      "type": "SEQ",
      "members": [
        {
          "type": "STRING",
          "value": "x"
        },
        {
          "type": "PATTERN",
          "value": "[0-9a-fA-F]{1,4}"
        }
      ]
    },
    "value": {
      "type": "SEQ",
      "members": [
        {
          "type": "CHOICE",
          "members": [
            {
              "type": "SYMBOL",
              "name": "negation"
            },
            {
              "type": "BLANK"
            }
          ]
        },
        {
          "type": "CHOICE",
          "members": [
            {
              "type": "SYMBOL",
              "name": "string"
            },
            {
              "type": "SYMBOL",
              "name": "digit"
            },
            {
              "type": "SYMBOL",
              "name": "decimal"
            },
            {
              "type": "SYMBOL",
              "name": "hexidecimal"
            },
            {
              "type": "ALIAS",
              "content": {
                "type": "SYMBOL",
                "name": "text"
              },
              "named": true,
              "value": "other"
            }
          ]
        }
      ]
    }
  },
  "extras": [
    {
      "type": "PATTERN",
      "value": "\\s"
    }
  ],
  "conflicts": [],
  "precedences": [],
  "externals": [],
  "inline": [],
  "supertypes": []
}

